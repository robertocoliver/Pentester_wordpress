Pentester na Wordpress
# Escopo e objetivo

Em um cenário de pentester, é importante que um profissional de tecnologia tenha conhecimento sobre CMS (Content Management System), que ajuda as pessoas a criarem sites sem a necessidade de saber programação ou entender as regras técnicas de funcionamento. A abstração de não precisar saber programar é o que faz o Wordpress, por exemplo, ser tão utilizado. Esses softwares são uma parte significativa dos sites da internet e compartilham características e vulnerabilidades em comum.
#

# Criando um laboratório

Baixe uma versão do wordpress 
```bash
  https://br.wordpress.org/download/releases/
```
Mova o arquivo para o diretório do servidor apache
```bash
  mv service apache2 restart                                                 
```
Descompactar o arquivo 
```bash
  tar -xvzf wordpress-6.2-pt_BR.tar.gz                                             
```
Iniciar o servidor apache
```bash
  service apache2 start                                           
```
 
# Configurando o wordpress
Primeiro, vamos criar um banco de dados para a nossa aplicação em Wordpress.
Criando banco de dados:
```bash
  CREATE database wordpress;
```
Criando um usuário para o wordpress:
```bash
  MariaDB [wordpress]> CREATE user 'wordpress1'@'localhost' identified by 'wordpress123';
```
wordpress1 - Definimos que o nome do usuário.
localhost - O usuário será acessivel pelo localhost. 
wordpress123 - senha.

Definindo o acesso do usuário ao banco de dados
```bash
  GRANT all ON wordpress.* to 'wordpress1'@'localhost';
```
![screenshot](https://github.com/robertocoliver/Pentester_wordpress/assets/102238044/b486045e-9d27-4d40-b52d-a408a871196a)

Alterando permissões: 
```bash
  chmod -R 755 wordpress 
```
Alterando o dono da pasta:
```bash
  chown -R www-data:www-data wordpress/ 
```
Verifique se as permissões foram aplicadas: 
```bash
  ls -la  
```
#
Caso tenha ocorrido tudo bem até aqui, veremos a etapa a seguir:
![screenshot](https://github.com/robertocoliver/Pentester_wordpress/assets/102238044/6568b9da-790a-4947-9878-379167bd4005)

# Desabilitar atualização automática do wordpress
Uma utilidade interessante dessa função é a instalação de versões antigas do WordPress para testar vulnerabilidades. Para isso, é necessário desabilitar a atualização automática do WordPress para que, por padrão, ele não tente instalar uma versão mais recente.

```bash
  nano /var/www/html/wordpress/wp-config-sample.php         
```
Adicione a função no final do arquivo: 

```bash
  define('WP_AUTO_UPDATE_CORE',false);         
```
Renomear o arquivo de configuração
```bash
  cp wp-config-sample.php wp-config.php       
```
Refazer as permissões:
```bash
  chrown -R www-data:www-data wordpress
```
Verifique se as permissões foram aplicadas: 
```bash
  chrown -R www-data:www-data wordpress
```
Como no nosso cenário vamos usar a aplicação mais recente do wordpress, esta ação não é necessária. 
#
![screenshot](https://github.com/robertocoliver/Pentester_wordpress/assets/102238044/8662da1b-fa5b-4cbf-947d-c4a40ba95e76)

## WPScan
WPScan é um software de teste de intrusão para escanear vulnerabilidades em aplicações que utilizam WordPress. Para utilizar o wpscan, é necessário realizar um cadastro no site wpscan.com/api e passar o token para a ferramenta.

```bash
  wpscan --url http://127.0.0.1/wordpress/ -e --api-token=token
```
![screenshot](https://github.com/robertocoliver/Pentester_wordpress/assets/102238044/792be27d-a577-4a06-ac03-219f528ab5f1)
Mesmo utilizando a versão 6.2, podemos ver que existe uma vulnerabilidade CRSF na aplicação. 
